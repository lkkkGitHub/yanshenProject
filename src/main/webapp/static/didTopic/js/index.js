define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/index",["ncPlugin/kindeditor/kindeditor","ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css","nc","cpn","../../../core/siteConfig"],function(o,e,t){o("ncPlugin/kindeditor/kindeditor"),o("ncPlugin/kindeditor/kindeditor/themes/nowcoder/nowcoder.css");var n=window.KindEditor,i=o("nc"),u=(o("cpn"),i.$),a=i.Cookie,r=i.Component,l=i.Clazz,d=(i.Browser,i.Base),h=i.Dom,c=o("../../../core/siteConfig"),s=t.exports=l.create();l.mix(s,r,{_template:'<div style="position:relative;"></div>',listeners:[{name:"render",type:"custom",handler:function(){var e=this,t=e.rawConfig;e.getEl();e.initEvent(),e.initPlugin(),t.disabled&&e.disable(),e.resize(t.width,t.height),e.initKe()}},{name:"destroy",type:"custom",handler:function(){try{this.keEditor.remove()}catch(e){}}}],create:function g(e,t){if(0===(e=u(e)).length)return;var o=(e.prop("tagName")||"").toLowerCase(),i="input"===o||"textarea"===o;return new s(d.extend({renderTo:e,renderBy:"replaceWith",content:i?e.val():"",height:Math.max(e.outerHeight(),200)},t))}},{initialize:function f(e){this._createdQueue=[]},initKe:function p(){this._initKePlugin();var e=this.getEl(),t=u("<div></div>");e.append(t);var o=this.keEditor=n.create(t.get(0),this._getConf()),i=o.html;o.html=function(e){return e?(e=e.replace(/\u00A0/g,"&nbsp;"),i.call(this,e)):i.apply(this,arguments)}},initPlugin:function m(){var t=this;t.waitCreated(function(){var e="toolbar,md,autoLink,imageBar,placeholder,uploadPaste,uploadRemote,codeName,defaultAction,monitContent,autoHeight,at".split(",");d.forEach(e,function(e){o.async("./plugin/"+e,function(e){new e(t)})})})},initEvent:function b(){var r=this,n=r.rawConfig,e=r.getEl();if(r._initEvent)return;r._initEvent=!0,r.listen("afterCreate",function(){r._afterCreate||(r._afterCreate=!0,n.content&&r.val(n.content),d.forEach(r._createdQueue,function(e){e&&e.call(r)}),r._createdQueue.length=0,e.on("click","div.js-editor-mask",function(){try{n.clickMask&&n.clickMask.call(r)}catch(e){}}),n.afterCreate&&n.afterCreate.call(r))}),r.listen("afterChange",function(){var e=r.keEditor,t=e.edit.cmd.range,o=r.isInTagNode(t.startContainer,"blockquote")||r.isInTagNode(t.endContainer,"blockquote");o?e.toolbar.select("bockquote"):e.toolbar.unselect("bockquote");var i=r.isInTagNode(t.startContainer,"pre")||r.isInTagNode(t.endContainer,"pre");e.edit.designMode&&(i?(e.toolbar.disableAll(!0,["source","codeblock"]),e.toolbar.select("codeblock")):(e.toolbar.disableAll(!1),e.toolbar.unselect("codeblock"))),n.afterChange&&n.afterChange.call(r)}),r.listen("afterBlur",function(){n.afterBlur&&n.afterBlur.call(r)}),r.listen("afterFocus",function(){n.afterFocus&&n.afterFocus.call(r)})},val:function k(){return this.keEditor.html.apply(this.keEditor,arguments)},text:function v(){return this.keEditor.text.apply(this.keEditor,arguments)},count:function w(){return this.keEditor.count("text")},blur:function E(){try{this.keEditor.blur()}catch(e){}},focus:function y(){try{this.keEditor.focus()}catch(e){}},disable:function x(t){var o=this.getEl();this.waitCreated(function(){var e=o.find(".js-editor-mask");if(!1===t)return e.hide();0===e.length&&(e=u('<div class="js-editor-mask" style="background:#fff;opacity:0;filter:alpha(opacity=0);position:absolute;width:100%;height:100%;top:0;left:0;z-index:999;"></div>'),o.append(e)),e.show()})},isEmpty:function C(){return this.keEditor.isEmpty()},resize:function T(r,n){var a=this,l=a.rawConfig,d=a.getEl();a.waitCreated(function(){var e=a.keEditor;if(r&&d.outerWidth(r),a.getEditorEl().width("auto"),n){var t=a.getToolbarEl(),o=t.outerHeight(),i=!l.noAutoHeight;n=Math.max(n-o-2,0),i&&(e.edit._editHeight=n+"px"),i&&a.autoHeight(),!i&&e.edit.setHeight(n)}})},autoHeight:function P(e){var t=this,o=t.rawConfig,i=t.keEditor,r=t.getEditorDoc();if(o.noAutoHeight)return;if(!e){var n=t.getEditorEl();e=h.getScrollParent(n),e=u(e||window)}var a=e.scrollTop();i.edit.setHeight(1);var l=r.body.scrollHeight;u(t.getEditorDoc().body).css("overflow","hidden"),t.getEditorEditEl().css("overflow","hidden").height(1),l=Math.max(l,r.body.scrollHeight);var d=t._lastHeight?l-t._lastHeight:0;t._lastHeight=l;var c=parseInt(i.edit._editHeight||0,10)||0;l=Math.max(l,c),i.edit.setHeight(l),e.scrollTop(a+(l===c?0:d))},waitCreated:function z(e){var t=this.keEditor;t&&t.isCreated?e&&e.call(this):this._createdQueue.push(e)},getEditor:function H(){return this.keEditor},getEditorDoc:function _(){return this.keEditor.edit.doc},getEditorWin:function N(){return this.keEditor.edit.win},getEditorEl:function q(){return u(this.keEditor.container[0])},getEditorEditEl:function B(){return u(this.keEditor.edit.div)},getToolbarEl:function M(){return u(this.keEditor.toolbar.div.get(0))},getCmdClosestEl:function A(){var e=this.keEditor.cmd.range.startContainer;for(;e&&1!==e.nodeType;)e=e.parentNode;return e},isInTagNode:function F(e,t){if(!e||!t)return!1;var o=!1;t=t.toLowerCase();try{for(;e;){var i=(e.tagName||"").toLowerCase();if(i&&i===t){o=!0;break}e=e.parentNode}}catch(r){}return o},removePlaceHolder:function D(){u(this.getEditorDoc()).find("#kePlaceholder").remove()},getElPos:function I(e){var t=this.getEl(),o=this.getEditorDoc(),i=u(o.body),r=h.getPosTop(e,i),n=h.getPosLeft(e,i),a=h.getPosTop(t),l=h.getPosLeft(t),d=this.getToolbarEl().outerHeight(),c=i.scrollTop(),s=i.scrollLeft();return{top:r+a+d-c,left:n+l-s}},_getConf:function K(){var e=this,t=e.rawConfig,o=d.clone(a.get());o.type=c.uploadType.image,o.token=a.get("csrf_token");var i={allowNCFileUpload:!0,allowFileManager:!0,themeType:"nowcoder",uploadJson:"/uploadImage",extraFileUploadParams:o,resizeType:0,height:(t.height||300)+"px",newlineTag:"div",cssData:['body{font-size:14px;background-color:transparent;font-family:arial,STHeiti,"Microsoft YaHei";line-height:1.8}',"a{color:#25bb9b;text-decoration: none;}","a:hover{color:#333}","img{max-width:100%;cursor:-moz-zoom-in;cursor:-webkit-zoom-in;cursor:zoom-in;cursor:url(//static.zhihu.com/static/img/zoom-in.cur)}","h1,h2,h3,h4,h5,h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}","h1{padding-bottom:.3em;font-size:2em;border-bottom:1px solid #eaecef}","h2{padding-bottom:.3em;font-size:1.5em;border-bottom:1px solid #eaecef}","h3{font-size:1.25em}","h4{font-size:1em}","h6{font-size:.85em;color:#6a737d}","blockquote,dl,ol,p,pre,table,ul{margin:12px 0}","ol,ul{padding-left:2em}","ul{list-style-type:disc}","li+li{margin-top:.25em}","ol{list-style-type:decimal}","ol ol ul,ol ul ul,ul ol ul,ul ul ul{list-style-type:square}","ol ol,ol ul,ul ol,ul ul{margin-top:0;margin-bottom:0;list-style-type:circle}","ol ol,ul ol{list-style-type:lower-roman}","ol ol ol,ol ul ol,ul ol ol,ul ul ol{list-style-type:lower-alpha}","blockquote{padding:0.25em 1em;color:#6a737d;border-left:2px solid #1abc9c}","pre{padding:0.25em 1em;overflow:auto;line-height:1.45;background-color:#f6f8fa;border-radius:0 3px 3px 0;border:none;border-left:2px solid #1abc9c}","em{font-weight:inherit;font-style:italic}","body>:last-child{margin-bottom:0!important}","pre{word-wrap:normal}","pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}","pre code,pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}","code,tt{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}","table{display:block;overflow:auto;width:auto;border:none;max-width:none;border-collapse:collapse;}","table tr{background-color:#fff;border-top:1px solid #c6cbd1}","table td,table th{padding:6px 13px;border:1px solid #dfe2e5}","table th{font-weight:600}","table tr:nth-child(2n){background-color:#f6f8fa}"].join(""),items:"source,preview,|,bold,italic,underline,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,|,image,|,table,subscript,superscript,math,removeformat".split(","),htmlTags:{span:".color,.font-weight,.text-decoration,.vertical-align".split(","),div:"class,id,align,.margin,.padding,.text-align,.color,.font-weight,.text-decoration,.vertical-align".split(","),table:"border,cellspacing,cellpadding,height,align,bordercolor,.padding,.margin,.border,bgcolor,.text-align,.color,.background-color,.font-weight,.text-decoration,.background,.height,.border-collapse".split(","),"td,th":"align,valign,width,height,colspan,rowspan,bgcolor,.text-align,.color,.background-color,.font-weight,.text-decoration,.vertical-align,.background,.border".split(","),a:"href,target,name,data-card-uid,class".split(","),embed:"src,width,height,wmode,name,allowfullscreen,flashvars,type,loop,autostart,quality,.width,.height,align,allowscriptaccess".split(","),object:"classid,width,height,id".split(","),param:"name,value".split(","),img:"class,id,src,width,height,border,alt,title,align,.width,.height,.border".split(","),"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":"align,.text-align,.color,.font-weight,.text-decoration,.vertical-align,.text-indent,.margin-left".split(","),pre:["class"],hr:"class,.page-break-after".split(","),iframe:"frameborder,width,height,src,allowfullscreen".split(","),"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":[]}},r=d.extend(i,t.keConf,{placeholder:t.placeholder,afterCreate:function(){e.keEditor=e.keEditor||this,e.fire("afterCreate")},afterChange:function(){e.keEditor=e.keEditor||this,e.waitCreated(function(){e.fire("afterChange")})},afterBlur:function(){e.keEditor=e.keEditor||this,e.fire("afterBlur")},afterFocus:function(){e.keEditor=e.keEditor||this,e.fire("afterFocus")}});t.isAdmin&&(r.items="source,preview,|,bold,italic,underline,forecolor,|,bockquote,codeblock,insertorderedlist,insertunorderedlist,link,|,image,|,table,subscript,superscript,math,removeformat".split(","));t.noCodeSelect||d.forReverse(r.items,function(e,t){"codeblock"===e&&r.items.splice(t,1)});return r},_initKePlugin:function L(){var r=this;if(s._initKePlugin)return;s._initKePlugin=!0,n.plugin("bockquote",function(){var i=this;i.clickToolbar("bockquote",function(){u("#kePlaceholder",i.edit.doc).remove(),i.select();var e=i.cmd.commonNode({blockquote:"*"});if(e){var t=i.cmd.range.createBookmark();e.remove(!0),i.cmd.range.moveToBookmark(t)}else{i.cmd.indent();var e=i.cmd.commonNode({blockquote:"*"});if(e){try{i.cmd.range.selectNodeContents(e),i.cmd.removeformat()}catch(o){}e.removeAttr("style"),!e.next()&&e.after("<br />")}}i.select(),r.fire("afterChange")})}),n.plugin("codeblock",function(){var i=this;i.clickToolbar("codeblock",function(){u("#kePlaceholder",i.edit.doc).remove(),i.select();var e=i.cmd.commonNode({pre:"*"});if(e){var t=i.cmd.range.createBookmark();e.remove(!0),i.cmd.range.moveToBookmark(t)}else{i.exec("formatblock","<pre>");var e=i.cmd.commonNode({pre:"*"});if(e){try{i.cmd.range.selectNodeContents(e),i.cmd.removeformat()}catch(o){}e.addClass("prettyprint"),!e.next()&&e.after("<br />")}}i.select(),r.fire("afterChange")})})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/at",["nc","ncpc"],function(t,e,n){var o=t("nc"),r=t("ncpc"),l=o.$,i=o.Base,a=(o.Dom,o.Clazz),d=n.exports=a.create(),g=r.AtList,c=r.Env;i.extend(d.prototype,{initialize:function s(t){var e=this;if(!(e.editor=t).rawConfig.needAt)return;e.id=i.ascId(),e.initIpt(t)},initIpt:function p(t){var n,o=this,e=150,r=g.getPool(o.id),i=l(t.getEditorDoc()),a=l(t.getEditorWin()),d=l(i).find("body");function s(){window.clearTimeout(n),n=window.setTimeout(function(){o.analyze()},e)}function c(t){o.cancelAt()&&t.preventDefault()}i.on("click",s),i.on("focus",s),i.on("keydown",function f(t){window.clearTimeout(n);var e=+t.keyCode;if(!{37:"left",38:"top",39:"right",40:"down",16:"shift",17:"ctrl",18:"option",91:"cmd"}[e]&&o.cancelAt())return void t.preventDefault();if(!{38:1,40:1,13:1}[e])return s();if(13===e&&r.isListMenuShow)return t.preventDefault()}),a.on("blur",function u(){window.clearTimeout(n),n=window.setTimeout(function(){g.showList(o.id)},e)}),d.on("paste",c),d.on("cut",c),d.on("copy",c)},analyze:function f(){var a=this,d=a.editor,s=d.keEditor,t=a.getAtInfo();if(!t)return g.showList(a.id);var e=a.getPos(t.range);g.showList(a.id,{ipt:d.getEditorDoc(),text:t.text,pos:e,ext:{top:5},ok:function(t){var e=d.getEditorDoc(),n=a.getAtInfo().range;c.isInDev(),t.id;s.insertHtml('​<a data-card-uid="'+t.id+'" href="javascript:void(0);">@'+t.nickname+'</a>&nbsp;<span id="jsNcAtTmpSpan"></span>'),n.deleteContents();try{var o=e.getElementById("jsNcAtTmpSpan");(n=e.createRange()).selectNodeContents(o),n.collapse(!1);var r=d.getEditorWin().getSelection();r.removeAllRanges(),r.addRange(n),o.parentNode.removeChild(o)}catch(i){}}})},getAtInfo:function u(){var t=this.editor.keEditor.cmd.range;if(!t.collapsed)return;if(this.getAtNodeByRange(t))return;var e,n=t.shrink().down().startContainer.data||"",o=t.startOffset-1,r=-1;for(;0<=o&&("@"===(e=n[o])&&(r=o),"@"!==e&&!/\s/.test(e));)o--;if(-1===r)return;if(0<r&&/[1-9a-z]/gi.test(n[r-1]))return;var i=t.cloneRange();return i.setStart(t.startContainer,r),{index:r,text:n.substring(r+1,t.startOffset),full:n.substring(r,t.startOffset),range:i}},getPos:function v(t){var e=this.editor,n=t.doc,o=n.createDocumentFragment(),r=n.getElementById("ncAtTmpHockSpan");r||((r=n.createElement("span")).id="ncAtTmpHockSpan");r.innerHTML="@",o.appendChild(r),t.insertNode(o);var i=e.getElPos(r),a=l(r).outerHeight();return r.parentNode.removeChild(r),{top:i.top+a,left:i.left}},cancelAt:function m(){var t=this,e=t.editor.keEditor;e.cmd.selection();var n=e.cmd.range,o=n.collapsed,r=t.getAtNodeByRange(n),i=o?r:t.getAtNodeByRange(n,!0);if(!r&&!i)return;var a=r,d=r!==i&&i?i:null,s=n.createBookmark();return a&&t.removeNode(a,!0),d&&t.removeNode(d,!0),n.moveToBookmark(s),e.select(),!0},getAtNodeByRange:function h(t,e){var n=t[e?"endContainer":"startContainer"],o=t[e?"endOffset":"startOffset"];if(1===n.nodeType){var r=n.childNodes;if(o=0<o?o-1:0,r.length>o)return this.getAtNode(r[o])}return this.getAtNode(n)},getAtNode:function A(t){for(;t;){var e=(t.nodeName||"").toLowerCase(),n=(t.className,t.getAttribute?t.getAttribute("data-card-uid"):"");if("a"===e&&(n||""===n))break;t=t.parentNode}return t},removeNode:function N(t,e){var n,o=(t||{}).parentNode;if(o){if(e&&t.hasChildNodes())for(;n=t.firstChild;)o.insertBefore(n,t);o.removeChild(t)}return t}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/autoHeight",["nc"],function(t,e,o){var i=t("nc"),a=i.$,n=i.Base,r=i.Dom,c=i.Clazz,u=o.exports=c.create();n.extend(u.prototype,{initialize:function g(o){if(o.rawConfig.noAutoHeight)return;var t=o.getEditorEl(),i=r.getScrollParent(t);i=a(i||window);var n=o.val();o.listen("afterChange",function(){var t=o.val();if(n!==t){n=t;try{o.autoHeight(i)}catch(e){}}}),n&&a(o.getEditorDoc()).one("click",function(){o.autoHeight(i)})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/autoLink",["nc"],function(e,t,r){var i=e("nc"),n=i.$,o=i.Base,a=i.Clazz,c=i.Browser,l=(i.Str,i.Html),u=r.exports=a.create();o.extend(u.prototype,{initialize:function d(r){if(c.ie())return;var e=r.getEditorDoc(),e=(r.keEditor,n(e));r.listen("afterBlur",function(){var e=r.val(),t=l.replaceLink(e);t!==e&&r.val(t)})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/codeName",["nc"],function(e,a,n){var t=e("nc"),h=t.$,u=t.Base,l=t.Clazz,o=n.exports=l.create(),y=window.KindEditor;u.extend(o.prototype,{initialize:function i(s){var v,d=s.keEditor,m=s.getEditorDoc(),p=s.getEditorWin();h(m).on("click","pre",function(e){if(e.shiftKey){var a=h(e.target),n=a.attr("class")||"",t=/lang-(.*)/.exec(n),l=t&&t[1]||"",o=y(s.getEditorEditEl().get(0)).pos(),i=y(a.get(0)).pos(),r=h(p).scrollTop()||h(m.body).scrollTop(),c=o.y+(i.y<r?0:i.y-r);v=d.menu=new y.MenuClass({name:"codename",width:150,centerLineMode:!1,x:o.x+i.x,y:c,z:50}),h(v.div).css({"max-height":"200px","overflow-y":"auto"});u.forEach([{name:"ASP/VB",val:"vb"},{name:"C/C++",val:"cpp"},{name:"CSS",val:"css"},{name:"C#",val:"cs"},{name:"HTML",val:"html"},{name:"Java",val:"java"},{name:"JavaScript",val:"js"},{name:"Perl",val:"pl"},{name:"PHP",val:"php"},{name:"Python",val:"py"},{name:"Ruby",val:"rb"},{name:"Shell",val:"bsh"},{name:"XML",val:"xml"},{name:"Other",val:""}],function(e){v.addItem({title:'<span unselectable="on">'+e.name+"</span>",checked:l===e.val,click:function(){e.val?a.removeClass().addClass("prettyprint lang-"+e.val):a.removeClass().addClass("prettyprint"),d.hideMenu()}})})}})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/defaultAction",["nc","cpn","ncpc"],function(a,t,e){var o=a("nc"),n=a("cpn"),i=a("ncpc"),r=o.$,u=o.Base,c=o.Clazz,d=o.Uri,l=n.Popup,f=n.PopupFormula,s=i.UploadRemote,h=e.exports=c.create();u.extend(h.prototype,{initialize:function p(a){var t=this.action=(a.rawConfig||{}).toolAction||{};this.initMath(a);var e=a.getEditor();u.forEach(t,function(a,t){e._handlers[t]=[a]})},initMath:function x(n){var i=this;u.extend(i.action,{clickToolbarmath:u.bind(i.math,i,n)}),r(n.getEditorDoc()).on("click","img",function(a){var t=r(a.currentTarget),e=t.attr("src"),o=d.getParam("tex",e);o&&i._formula({useLaTex:!0,value:o,valueLaTex:"$ "+o+" $",eidtor:n,call:function(a){t.attr("src",a).attr("data-ke-src",a)},callLaTex:function(a){t.replaceWith(a)}})})},math:function v(t){this._formula({useLaTex:!0,eidtor:t,call:function(a){t.getEditor().exec("insertimage",a)}})},_formula:function m(c){var t=c.eidtor;f.show({useLaTex:!!c.useLaTex,value:c.value,valueLaTex:c.valueLaTex,uploadBatch:function(t,a,n){var i=this.showLoad(),c=t.length,r=0,l={};if(0===c)return n(l);u.forEach(a,function(e,a){var o=t[a];s.upload(e,function(a){r++;var t=a&&a!==e;l[o]=t?d.addParam({tex:o},a):"",c<=r&&(i.close(),n&&n(l))})})},callLaTex:function(a){r.trim(a)&&(c.callLaTex&&c.callLaTex(a),!c.callLaTex&&t&&t.getEditor().insertHtml(a))},upload:function(e,o,n){var i=this.showLoad();s.upload(o,function(a){i.close();var t=a&&a!==o;!t&&l.alert("出现错误，请重试"),t&&(a=d.addParam({tex:e},a),c.call&&c.call(a),n&&n())})}})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/imageBar",["nc"],function(t,i,o){var e=t("nc"),u=e.$,n=e.Base,a=e.Clazz,l=e.Dom,c=e.Uri,r=o.exports=a.create();n.extend(r.prototype,{initialize:function w(t){var o,d=t.getEl(),h=u(['<div class="js-editor-img-bar editor-img-bar" style="display:none;width:60px;">','<a href="javascript:void(0);" title="放大" class="icon-zoom-in"></a>','<a href="javascript:void(0);" title="缩小" class="icon-zoom-out"></a>',"</div>"].join(""));u(document.body).append(h),t.listen("destroy",function(){h.remove()});var s=t.getEditorDoc();u(s).on("keydown",function(t){window.clearTimeout(o),h.unbind("click").hide()}),u(s).on("click",function(t){window.clearTimeout(o),h.unbind("click").hide();var r=t.target,i=u(r).attr("src")||"";"img"!==(r.tagName||"").toLowerCase()||c.getParam("tex",i)||(o=window.setTimeout(function(){var t=r.width,i=r.height;if(t&&i){var o=l.getPosTop(r,s.body),e=l.getPosLeft(r,s.body),n=l.getPosTop(d),a=l.getPosLeft(d);h.css("top",n+o+40).css("left",a+e+1).show();var c=null;h.on("click","a.icon-zoom-in",function(t){var i=u(r).width();u(r).removeAttr("width height").height("auto"),c=c||u(r).width("auto").width();var o=(Math.round(10*i/c)+1)/10;u(r).width(5<o?i:c*o)}),h.on("click","a.icon-zoom-out",function(t){var i=u(r).width();u(r).removeAttr("width height").height("auto"),c=c||u(r).width("auto").width();var o=(Math.round(10*i/c)-1)/10;u(r).width(o<.1?i:c*o)})}},25))}),u(document.body).on("click",function(t){var i=t.target;i===h.get(0)||u.contains(h.get(0),i)||(window.clearTimeout(o),h.unbind("click").hide())})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/md",["nc","cpn"],function(e,i,o){var t=e("nc"),n=e("cpn"),r=t.$,a=t.Base,d=t.Clazz,l=n.Popup,c=o.exports=d.create();a.extend(c.prototype,{initialize:function h(e){var i=this;if(!(i.editor=e).rawConfig.needChangeEditor)return;var o=r('<a class="ico-to-html js-2-md">MD编辑器</a>');e.getToolbarEl().prepend(o),o.on("click",function(){i.changeEditor()})},changeEditor:function p(){var o=this.editor,t=o.rawConfig,n=o.getEl(),d=o.val();if(o.isEmpty())return void e.async("../../mdEditor",function(e){i(e)});function i(e){var i=new e({renderTo:n,renderBy:"after",isAdmin:t.isAdmin,content:e.html2md(d),needChangeEditor:!0,needAt:!!t.needAt,afterChangeEditor:t.afterChangeEditor,width:t.width,height:t.height,draftChange:t.draftChange,disabled:t.disabled,clickMask:t.clickMask,noToolbarFixed:t.noToolbarFixed,toolbarFixedTop:t.toolbarFixedTop,noAutoHeight:t.noAutoHeight,render:function(){o.destroy()}});t.afterChangeEditor&&t.afterChangeEditor.call(o,i),o.fire("changeEditor",i),n.hide()}e.async("../../mdEditor",function(a){var e=l.confirm('切换到 MarkDown 编辑器可能会丢失部分内容格式，确认切换？<a class="link-green" href="javascript:void(0);">预览转换后的效果</a>',function(){i(a)});e&&e.getEl().find("a.link-green").on("click",function(e){var i=a.html2md(d),o=a.md2html(i),t=window.open(),n=t.document;n.open("text/html","replace");var r=["html{margin:0;padding:0}","body{margin:0;padding:5px;}","body, td {font-size:14px;line-height:20px;}","body, p, div {word-wrap: break-word;}","p {margin:5px 0;}","table {border-collapse:collapse;}","img {border:0;}","noscript {display:none;}","table.ke-zeroborder td {border:1px dotted #AAA;}",'body{background-color:transparent;font-family:arial,STHeiti,"Microsoft YaHei";line-height:1.8}',"table{width:100%;}","p{line-height:1.8}","h1,h2,h3,h4,h5,h6{margin:10px 0}","img{max-width:100%}",'blockquote{position:relative;color: #999;font-weight:300;font-family:Avenir, "Helvetica Neue", "Microsoft Yahei", "Hiragino Sans GB", "Microsoft Sans Serif", "WenQuanYi Micro Hei", sans-serif;border-left:2px solid #1abc9c;padding: 10px 0 10px 10px;margin: .8em 0;}',"pre{font-size: 14px;position: relative;border-left: 2px solid #1abc9c;padding: 10px 0 10px 10px;margin: .8em 0;background: #fefefe;word-break:break-all;}","a{color:#25bb9b;text-decoration:none;}"].join("");n.write("<html><head><title>预览</title><style>"+r+"</style></head><body>"+o+"</body></html>"),n.close()})})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/monitContent",["nc"],function(e,t,n){var a=e("nc"),c=a.$,i=a.Base,r=a.Clazz,o=n.exports=r.create();i.extend(o.prototype,{initialize:function d(i){var r,o,f=i.rawConfig;if(f.draftChange){var e=window.setInterval(t,1600);i.listen("destroy",function(){window.clearInterval(e)})}function t(){i.waitCreated(function(){try{var e=(new Date).getTime();if(r){if(800<e-r){var t=o||"",n=c.trim(i.val());r=e,(o=n)!==t&&(i.fire("draftChange"),f.draftChange&&f.draftChange.call(i,n))}}else r=e}catch(a){}})}i.listen("afterChange",t)}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/placeholder",["nc"],function(e,o,n){var d=e("nc"),t=d.$,l=d.Base,i=d.Clazz,r=n.exports=i.create();l.extend(r.prototype,{initialize:function c(e){var o,n,d,l=e.rawConfig,i=t(e.getEditorDoc()),r=i.get(0).body;i.on("mousedown",d=function(){o&&(e.removePlaceHolder(),o=!0),i.unbind("mousedown",d)}),l.placeholder&&e.isEmpty()&&(r.innerHTML='<div id="kePlaceholder" style="color:#ddd;">'+l.placeholder+"</div>",o=!0);e.listen("afterBlur",function(){l.placeholder&&""===e.val()&&(r.innerHTML='<div id="kePlaceholder" style="color:#ddd;">'+l.placeholder+"</div>",o=!0)}),e.listen("afterFocus",function(){e.removePlaceHolder(),n||(n=window.setTimeout(function(){e.removePlaceHolder(),n=null},0))})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/toolbar",["nc","cpn","../../../select"],function(e,t,i){var n=e("nc"),o=e("cpn"),p=n.$,r=n.Base,a=n.Clazz,f=n.Dom,x=n.Time,l=o.Tips,s=e("../../../select"),c=i.exports=a.create();r.extend(c.prototype,{initialize:function d(e){var t=this;t.editor=e,t.initFullScreen(),t.initTips(),t.initFix(),t.initCodeSelect()},initFullScreen:function u(){var e=this.editor,t=e.rawConfig;if(t.fullScreen){var i=p('<a href="javaScript:void(0);" class="full-ico"></a>');e.getToolbarEl().append(i),i.on("click",t.fullScreen)}},initTips:function v(){var t=this.editor,e=(t.rawConfig,t.getToolbarEl().find("span.ke-outline"));l.titleEl(e,{verReverse:!0},function(e){t.pushChild(e)})},initFix:function h(){var e=this.editor,t=e.rawConfig;if(t.noToolbarFixed)return;var n,o,r=p(window),a=+t.toolbarFixedTop||0,l=e.getEditorEl(),c=e.getToolbarEl(),i=x.frequency(10),s=0,d=!0;function u(){(0===s&&d||0<s)&&(d&&window.setTimeout(v,1200),!d&&v(),d=!1)}function v(){i(function(){s++;var e=l.outerHeight(),t=r.scrollTop(),i=f.getPosTop(l);i<t+a&&t+a+o<i+e?(n||(n=c.width()||0),c.css("width",n),l.addClass("fixed-eidt-header"),c.css("top",a)):(l.removeClass("fixed-eidt-header"),c.css("top",null),c.css("width","auto"))})}o=c.outerHeight(),r.on("scroll",u),e.listen("destroy",function(){r.unbind("scroll",u)})},initCodeSelect:function m(){var a=this.editor;if(a.rawConfig.noCodeSelect)return;var l=a.keEditor,c=function t(n){var e=a.getToolbarEl();return new s({renderTo:e,renderBy:"prepend",size:"small",text:"代码语言",options:[{text:"ASP/VB",value:"vb"},{text:"C/C++",value:"cpp"},{text:"CSS",value:"css"},{text:"C#",value:"cs"},{text:"HTML",value:"html"},{text:"Java",value:"java"},{text:"JavaScript",value:"js"},{text:"Perl",value:"pl"},{text:"PHP",value:"php"},{text:"Python",value:"py"},{text:"Ruby",value:"rb"},{text:"Shell",value:"bsh"},{text:"XML",value:"xml"},{text:"其他",value:""}],change:function(){var e=this.val();a.removePlaceHolder(),n.cmd.selection(),n.select();var t=n.cmd.commonNode({pre:"*"});if(!t&&(n.exec("formatblock","<pre>"),t=n.cmd.commonNode({pre:"*"}))){try{n.cmd.range.selectNodeContents(t),n.cmd.removeformat()}catch(i){}t.addClass("prettyprint"),t.next()||t.after("<br />")}p(t).removeClass().addClass("prettyprint "+(e?"lang-"+e:"")),n.select(),a.fire("afterChange")}})}(l);a.listen("afterChange",function(){var e=l.edit.cmd.range,t=a.isInTagNode(e.startContainer,"pre")||a.isInTagNode(e.endContainer,"pre");if(t){var i=l.cmd.commonNode({pre:"*"});if(i){var n=i.attr("class")||"",o=/lang-(.*)/.exec(n),r=o&&o[1]||"";c.val(r)}}else c.clear()})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/uploadPaste",["nc","cpn"],function(e,n,o){var p=e("nc"),t=e("cpn"),l=(p.$,p.Base),r=p.Clazz,u=p.Dom,i=o.exports=r.create();l.extend(i.prototype,{initialize:function c(e){if(e.rawConfig.noPasteUpload)return;var n,i=e.getEditor(),o=e.getEditorDoc();function a(){return n||(n=t.PopupUploadTips.show({})).popup.listen("close",function(){n=null}),n}u.bindPaste(o,o.body,function(e,n){var o=l.find(e,function(e){return"file"===e.kind&&/image/.test(e.type||"")}),t=o?o.getAsFile():null;if(t){n&&n.preventDefault&&n.preventDefault();var r=new p.Upload({url:"/uploadImage?type=1",progress:function(e){var n=a();n.showProgress("正在上传："+e+"%",e)},error:function(){var e=a();e.showError("上传失败")},call:function(e){var n=a();n.close(),i.exec("insertimage",e.url)}});r.uploadBlob(t,(new Date).getTime()+"."+(t.type||"").split("/").pop())}})}})});
define("nowcoder/1.2.1125/javascripts/component/editorSub/hEditor/plugin/uploadRemote",["nc","cpn","ncpc"],function(t,n,o){var e=t("nc"),r=t("cpn"),a=t("ncpc"),d=e.$,f=e.Base,i=e.Clazz,u=r.Popup,l=a.UploadRemote,c=o.exports=i.create();f.extend(c.prototype,{initialize:function s(c){if(c.rawConfig.noUploadRemote)return;var p=!1;function t(){if(!p){var t=c.getEditorDoc(),n=d(t.body).find("img"),e=n.length;if(0!==e){var o=f.map(n,function(t){return d.trim(d(t).attr("src"))});if(l.canUpload(o)){var r=function i(){return new u({hasNoTitle:!0,hasNoFooter:!0,noUnique:!0,content:'<div style="font-size:14px;text-align:center;">图片上传中...</div>'})}();p=!0;var a=0;f.forEach(n,function(n){n=d(n);var o=d.trim(n.attr("src"));l.upload(o,function(t){t&&t!==o&&(n.attr("src",t),n.attr("data-ke-src",t)),e<=++a&&(p=!1,r.close())})})}}}}c.listen("draftChange",t),t()}})});