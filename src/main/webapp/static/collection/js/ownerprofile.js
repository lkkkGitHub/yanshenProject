define("nowcoder/1.2.1150/javascripts/site/profile/ownerProfile",["nc","cpn","ncpc","../../core/siteConfig","../../action/contest","../../util/util","../../util/littleAction","../../action/note"],function(i,t,n){var o=i("nc"),a=i("cpn"),e=i("ncpc"),f=o.$,c=o.Sys,l=o.Base,r=o.Limit,w=o.Dom,p=o.Time,d=a.Popup,s=a.PopupImage,u=e.PopupMsg,v=e.Bll,g=e.PopupReport,h=i("../../core/siteConfig"),m=i("../../action/contest"),k=i("../../util/util"),b=i("../../util/littleAction");c.ready({initialize:function y(){var i=this;i.initNav(),i.initAvatar(),i.initLogClock(),i.initFollow(),i.initMsg(),i.initBlack(),i.initReport()},initNav:function C(){var i=p.frequency(10),n=f(window),o=f(".nk-main"),t=o.find(".profile-info-wrapper"),a=f(t.get(0).cloneNode(!0)).addClass("fixed");o.addClass("with-fixed-bar"),t.after(a);var e=k.getNavHeight(),c=t.outerHeight(),l=a.outerHeight(),r=w.getPosTop(t),d=c+r-2-e-l,s=!1;function u(){i(function(){var i=n.scrollTop(),t=d<i;t&&!s?(o.addClass("with-fixed-bar"),a.fadeIn(250)):!t&&s&&(o.removeClass("with-fixed-bar"),a.hide()),s=t})}o.removeClass("with-fixed-bar"),a.hide(),n.on("scroll",u),u()},initAvatar:function x(){var t=f(".js-self-avatar");v.avatar({el:t,attach:function(i,t){var n=f('<div class="change-photo"></div>');t.append(n),i.attach.listen("attachShow",l.bind(n.show,n,null)),i.attach.listen("attachHide",l.bind(n.hide,n,null))},call:function(i){t.find("img").attr("src",i),f("div.nowcoder-header div.img-box img").attr("src",i)}}),f(".profile-info-main").on("click","a.head-pic",function(i){var t=f(i.currentTarget),n=t.find("img"),o=f.trim(n.attr("src"));o&&!t.hasClass("js-self-avatar")&&(-1!==o.indexOf("images.nowcoder.com")&&(o=o.split("@")[0]),s.show(o))})},initLogClock:function T(){var i=-1!==(window.location.href||"").indexOf("clockInfo");b.clock({el:f(".js-log-clock"),ok:i?function(){window.location.reload()}:null})},initFollow:function j(){var o=(window.curUser||{}).id;f("#followers-count"),f("#followers-count").text();window.isLogin&&o&&(f(document).on("click","a.click-follow",i),f(document).on("click","a.click-unfollow",i));function i(i){var t=f(i.currentTarget),n=t.hasClass("click-follow");!r.mark(t)&&m[n?"follow":"unfollow"]({body:{id:o,type:h.type.user},call:function(){w.cls(t,{"click-unfollow btn-default fui-check":n,"click-follow btn-primary fui-plus":!n}),t.html(n?" 已关注":" 关注"),t.attr("title",n?"取消关注":"关注")},error:function(i){d.alert(i.msg)},always:function(){r.pause(t)}})}},initMsg:function P(){window.isActive&&window.isLogin&&f(document).on("click","a.click-send-message",function(i){var t=f(i.currentTarget),n=t.attr("data-sender-id"),o=t.attr("data-sender-name");n&&u.show({title:"发私信",content:"Hi",receiver:{name:o||"牛客人",id:n}})})},initBlack:function A(){f(document).on("click",".js-black",function(i){var t=f(i.currentTarget);v.black({id:t.attr("data-id"),name:t.attr("data-name"),black:"0"===(t.attr("data-blacktype")||"0"),call:function(){window.location.reload()}})})},initReport:function H(){f(document).on("click",".js-report",function(i){var t=f(i.currentTarget);g.show({type:h.type.user,entityId:t.attr("data-id")})})}})});